# Журнал выполнения проекта "gb_altinvest"
(Диплом по направлению "Специалист по ИИ", 2025)

---

## 2025-05-21

### 1. Сформулирован план реализации дипломного проекта
Определена основная идея работы: анализ взаимосвязи альтернативных данных (вакансии, новости) с котировками акций. Зафиксированы цели, задачи и ожидаемые результаты.

### 2. Выбран технологический стек
Принят следующий стек технологий:
- Python (pandas, plotly, sklearn) — для анализа и визуализации данных
- PHP — для реализации веб-интерфейса
- Docker (docker-compose) — для изоляции и автоматизации развёртывания
- Airflow — для организации ETL и расписания
- (Опционально) Telegram-бот для доставки результатов

### 3. Попытка получения архивных котировок по Казахстану (KASE, AIX)
Осуществлён поиск и предпринята попытка получения архивных котировок по тикерам Kcell (KCEL), Halyk Bank (HSBK), КазАтомПром (KAP), а также по индексу KASE с официальных источников KASE и AIX.  
Установлено, что архивы по тикерам доступны через API (например, Tradernet), а архив индекса KASE в пригодном виде отсутствует. Автоматизация получения данных по индексу KASE признана затруднительной.

### 4. Корректировка набора тикеров
В связи с отсутствием индекса KASE в удобном для работы формате, принято решение исключить его из анализа. Для дальнейшей работы утверждён следующий набор тикеров: Kcell (KCEL), Halyk Bank (HSBK), КазАтомПром (KAP/KZAP/KAP.AIX).

### 5. Принято решение о резервном плане на случай проблем с данными
В случае невозможности получения достаточного объёма данных по казахстанским бумагам подготовлен альтернативный сценарий перехода на российские инструменты с выгрузкой архивов с moex.com.

### 6. Создан репозиторий и инициализирован проект
Создан репозиторий на GitHub (`gb_altinvest`), добавлен файл README.md, настроена синхронизация с локальной папкой GB_AI_Specialist_Diplom. Зафиксирована структура основных рабочих папок.

---

## 2025-05-22

### 7. Принято решение реализовать автоматизированный сбор исторических данных через интеграцию с Tradernet API
Проведено тестирование работы с Tradernet Public API. Получение исторических котировок по необходимым тикерам прошло успешно. Принято решение реализовать автоматизированный сбор и обновление данных с использованием данного API в рамках собственного веб-сервиса.

### 8. Начата разработка контейнеризованного веб-сервиса
Принято решение о создании микросервисной архитектуры проекта с использованием контейнеризации (Docker Compose). Начата настройка docker-compose.yml с сервисами PHP (web), MySQL (db), phpMyAdmin, python-analysis, airflow, telegram-bot.

### 9. Добавлены и описаны файлы конфигурации php.ini и Apache (vhosts/default.conf)
Внесены рабочие настройки лимитов, часового пояса, вывода ошибок в php.ini. Сконфигурирован виртуальный хост Apache с разрешением .htaccess и настройками для разработки и тестирования. Описание и рекомендации вынесены в README.md.

### 10. Разработан и внедрён .htaccess для html/ и siteroot/
Созданы файлы .htaccess для корневой папки html и директории siteroot/ с правилами защиты, маршрутизации запросов, доступа к статикам и ограничения доступа к системным папкам. Описание внесено в README.md.

### 11. Создан файл index.php для siteroot/
Разработан минималистичный файл index.php, реализующий базовую логику инициализации, обработки ошибок и запуска основного приложения. В файле обеспечено подключение конфигурации, регистрация обработчика ошибок и запуск приложения через $app->run().

### 12. Создан и внедрён контейнер python-analysis с интеграцией веб-сервиса для сбора данных
Создан отдельный контейнер python-analysis для автоматизации сбора и анализа данных. Реализована интеграция с внутренним PHP-веб-сервисом, через который осуществляется доступ к Tradernet API (подготовлен отдельный класс-клиент, проведено тестирование).  
Настроено монтирование volume ./data/python/ для обмена данными и результатами между сервисами.

### 13. Выполнена сборка и запуск всех сервисов через Docker Compose
Проект собран и запущен с помощью docker-compose up --build. Проверена работоспособность всех ключевых сервисов, структура volumes и конфигов.

---

# (Все рутинные настройки volumes, служебные папки и .gitkeep фиксируются только в README.md, а не в history.md)

## 2025-05-22

### 19. Создан и структурирован файл config/init.json для приложения AltInSight
В папке config создан и оформлен файл init.json, в котором централизованно хранятся настройки приложения, параметры авторизации и безопасности, события для логирования, подключение к базе данных и ключи интеграции с Tradernet. Описание структуры файла добавлено в README.md.

### 20. Создан базовый web-контроллер для тестирования интеграции с Tradernet API
Реализован метод testTradernetApi, позволяющий получать и отображать котировки по тикеру KCEL через веб-интерфейс.  
Контроллер подготовлен к расширению для работы с другими тикерами и доработке шаблонов вывода данных. Планируется добавить обработку ошибок, универсализацию тикеров и улучшить автозагрузку классов.

### 21. Актуализирована и зафиксирована структура проекта после реализации веб-сервиса
Структура проекта расширена и уточнена: 
- В папке html/ реализована чёткая структура MVC: app/Core, app/Domain, app/Infrastructure, app/Presentation;
- Добавлены контроллеры и хендлеры для API (html/API/);
- Все рабочие и обменные папки (data/python, data/tgbot, logs/, storage/logs/) оформлены и снабжены служебными файлами .gitkeep;
- Описаны новые уровни абстракции для ядра, сервисов и клиента внешних API.
Актуальная структура проекта добавлена в README.md и используется для сопровождения дальнейшей документации.

### 22. Реализован сервис экспорта котировок в JSON/CSV для Python-аналитики
Создан отдельный QuotesExportService, обеспечивающий сохранение котировок по каждому тикеру в формате JSON и CSV в общую папку data/python/quotes/ (volume, доступный для PHP и Python-контейнеров).

Все экспортируемые файлы имеют актуальное содержимое, старые версии не накапливаются — всегда сохраняется свежий срез по каждому тикеру.

### 23. Разработан CLI-скрипт для пакетного экспорта котировок
Написан отдельный PHP-скрипт (export_all_quotes.php), обеспечивающий автоматический экспорт котировок для всех поддерживаемых тикеров за указанный период.

Скрипт может запускаться вручную, через cron или из DAG Airflow, поддерживает централизованную интеграцию между сервисами и аналитическим пайплайном.

Исправлены ошибки путей и организации volume в docker-compose; скрипт корректно подключает ядро приложения из /var/www/html/bootstrap.php.

### 24. Организован централизованный volume обмена данными между сервисами
В docker-compose.yml настроено одновременное монтирование data/python для сервисов web (PHP), python-analysis и airflow.

Все сервисы могут читать и писать общие данные (quotes) для передачи между этапами ETL и аналитики.

### 25. Проведено тестирование обмена: полная выгрузка котировок из Tradernet, запись в файл, последующее чтение из Python
Проверена работоспособность сценария: экспорт → чтение в pandas.

Все обменные форматы и скрипты готовы к автоматизации через Airflow DAG.

